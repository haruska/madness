<% content_for(:add_js) do %>
  <%= javascript_include_tag "reactComponents" %>
<% end %>

<div class="bracket-container">
  <div class="bracket-heading">
    <h2><%= "#{@bracket.name} (#{@bracket.user.name})" %></h2>
    <div>
      <% if policy(@bracket).update? %>
        <div class="bracket-actions">
          <%= link_to "Edit Bracket", "/brackets/#{@bracket.id}/edit", class: "button edit" %>
        </div>
      <% end %>
    </div>
  </div>
  <div class="tournament-component">
    <%=
      @tournament = Tournament.field_64

      react("Tournament", props: {
        bracket: {
          name: @bracket.name,
          gameDecisions: @bracket.game_decisions.to_s,
          gameMask: 18446744073709551614.to_s
        },
        tournament: {
          id: "field64",
          tipOff: @tournament.tip_off.iso8601,
          gameDecisions: @tournament.game_decisions.to_s,
          gameMask: @tournament.game_mask.to_s,
          started: @tournament.started?,
          rounds: @tournament.rounds.map {|round|
            {
              name: round.name,
              number: round.number,
              startDate: round.start_date.iso8601,
              endDate: round.end_date.iso8601,
              regions: round.regions
            }
          },
        },
        teams: Tournament.field_64.teams.map {|team|
          {
            id: team.id,
            startingSlot: team.starting_slot,
            seed: team.seed,
            name: team.name,
            stillPlaying: team.still_playing?
          }
        }
      })
    %>
  </div>
</div>
